nohup: å¿½ç•¥è¾“å…¥
New https://pypi.org/project/ultralytics/8.3.86 available ðŸ˜ƒ Update with 'pip install -U ultralytics'
Ultralytics 8.3.62 ðŸš€ Python-3.12.2 torch-2.5.1+cu124 CUDA:0 (NVIDIA GeForce RTX 3090, 24259MiB)
                                                      CUDA:1 (NVIDIA GeForce RTX 3090, 24260MiB)
                                                      CUDA:2 (NVIDIA GeForce RTX 3090, 24260MiB)
                                                      CUDA:3 (NVIDIA GeForce RTX 3090, 24260MiB)
[34m[1mengine/trainer: [0mtask=segment, mode=train, model=/home/xin99/BloodScan/tests/yolo_seg/weights/yolo11x-seg.pt, data=/home/xin99/BloodScan/tests/yolo_seg/datasets/Blue-Rawdata-1504-500-1/data.yaml, epochs=200, time=None, patience=100, batch=8, imgsz=1504, save=True, save_period=-1, cache=False, device=0,1,2,3, workers=8, project=None, name=train4, exist_ok=False, pretrained=True, optimizer=auto, verbose=True, seed=0, deterministic=True, single_cls=False, rect=False, cos_lr=False, close_mosaic=10, resume=False, amp=True, fraction=1.0, profile=False, freeze=None, multi_scale=False, overlap_mask=True, mask_ratio=4, dropout=0.0, val=True, split=val, save_json=False, save_hybrid=False, conf=None, iou=0.7, max_det=300, half=False, dnn=False, plots=True, source=None, vid_stride=1, stream_buffer=False, visualize=False, augment=False, agnostic_nms=False, classes=None, retina_masks=False, embed=None, show=False, save_frames=False, save_txt=False, save_conf=False, save_crop=False, show_labels=True, show_conf=True, show_boxes=True, line_width=None, format=torchscript, keras=False, optimize=False, int8=False, dynamic=False, simplify=True, opset=None, workspace=None, nms=False, lr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=7.5, cls=0.5, dfl=1.5, pose=12.0, kobj=1.0, nbs=64, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, bgr=0.0, mosaic=1.0, mixup=0.0, copy_paste=0.0, copy_paste_mode=flip, auto_augment=randaugment, erasing=0.4, crop_fraction=1.0, cfg=None, tracker=botsort.yaml, save_dir=runs/segment/train4
Overriding model.yaml nc=80 with nc=3

                   from  n    params  module                                       arguments                     
  0                  -1  1      2784  ultralytics.nn.modules.conv.Conv             [3, 96, 3, 2]                 
  1                  -1  1    166272  ultralytics.nn.modules.conv.Conv             [96, 192, 3, 2]               
  2                  -1  2    389760  ultralytics.nn.modules.block.C3k2            [192, 384, 2, True, 0.25]     
  3                  -1  1   1327872  ultralytics.nn.modules.conv.Conv             [384, 384, 3, 2]              
  4                  -1  2   1553664  ultralytics.nn.modules.block.C3k2            [384, 768, 2, True, 0.25]     
  5                  -1  1   5309952  ultralytics.nn.modules.conv.Conv             [768, 768, 3, 2]              
  6                  -1  2   5022720  ultralytics.nn.modules.block.C3k2            [768, 768, 2, True]           
  7                  -1  1   5309952  ultralytics.nn.modules.conv.Conv             [768, 768, 3, 2]              
  8                  -1  2   5022720  ultralytics.nn.modules.block.C3k2            [768, 768, 2, True]           
  9                  -1  1   1476864  ultralytics.nn.modules.block.SPPF            [768, 768, 5]                 
 10                  -1  2   3264768  ultralytics.nn.modules.block.C2PSA           [768, 768, 2]                 
 11                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          
 12             [-1, 6]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 13                  -1  2   5612544  ultralytics.nn.modules.block.C3k2            [1536, 768, 2, True]          
 14                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          
 15             [-1, 4]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 16                  -1  2   1700352  ultralytics.nn.modules.block.C3k2            [1536, 384, 2, True]          
 17                  -1  1   1327872  ultralytics.nn.modules.conv.Conv             [384, 384, 3, 2]              
 18            [-1, 13]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 19                  -1  2   5317632  ultralytics.nn.modules.block.C3k2            [1152, 768, 2, True]          
 20                  -1  1   5309952  ultralytics.nn.modules.conv.Conv             [768, 768, 3, 2]              
 21            [-1, 10]  1         0  ultralytics.nn.modules.conv.Concat           [1]                           
 22                  -1  2   5612544  ultralytics.nn.modules.block.C3k2            [1536, 768, 2, True]          
 23        [16, 19, 22]  1   8325497  ultralytics.nn.modules.head.Segment          [3, 32, 384, [384, 768, 768]] 
YOLO11x-seg summary: 667 layers, 62,053,721 parameters, 62,053,705 gradients, 319.7 GFLOPs

Transferred 1071/1077 items from pretrained weights
[34m[1mDDP:[0m debug command /home/xin99/anaconda3/envs/bloodScan/bin/python -m torch.distributed.run --nproc_per_node 4 --master_port 37811 /home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py
Ultralytics 8.3.62 ðŸš€ Python-3.12.2 torch-2.5.1+cu124 CUDA:0 (NVIDIA GeForce RTX 3090, 24259MiB)
                                                      CUDA:1 (NVIDIA GeForce RTX 3090, 24260MiB)
                                                      CUDA:2 (NVIDIA GeForce RTX 3090, 24260MiB)
                                                      CUDA:3 (NVIDIA GeForce RTX 3090, 24260MiB)
Overriding model.yaml nc=80 with nc=3
Transferred 1071/1077 items from pretrained weights
Freezing layer 'model.23.dfl.conv.weight'
[34m[1mAMP: [0mrunning Automatic Mixed Precision (AMP) checks...
[34m[1mAMP: [0mchecks passed âœ…
[34m[1mtrain: [0mScanning /home/xin99/BloodScan/tests/yolo_seg/datasets/Blue-Rawdata-1504-500-1/train/labels.cache... 1080 images, 0 backgrounds, 0 corrupt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080/1080 [00:00<?, ?it/s][34m[1mtrain: [0mScanning /home/xin99/BloodScan/tests/yolo_seg/datasets/Blue-Rawdata-1504-500-1/train/labels.cache... 1080 images, 0 backgrounds, 0 corrupt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1080/1080 [00:00<?, ?it/s]
[34m[1mval: [0mScanning /home/xin99/BloodScan/tests/yolo_seg/datasets/Blue-Rawdata-1504-500-1/valid/labels.cache... 100 images, 0 backgrounds, 0 corrupt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:00<?, ?it/s][34m[1mval: [0mScanning /home/xin99/BloodScan/tests/yolo_seg/datasets/Blue-Rawdata-1504-500-1/valid/labels.cache... 100 images, 0 backgrounds, 0 corrupt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:00<?, ?it/s]
Plotting labels to runs/segment/train4/labels.jpg... 
[34m[1moptimizer:[0m 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically... 
[34m[1moptimizer:[0m AdamW(lr=0.000714, momentum=0.9) with parameter groups 176 weight(decay=0.0), 187 weight(decay=0.0005), 186 bias(decay=0.0)
Image sizes 1504 train, 1504 val
Using 32 dataloader workers
Logging results to [1mruns/segment/train4[0m
Starting training for 200 epochs...

      Epoch    GPU_mem   box_loss   seg_loss   cls_loss   dfl_loss  Instances       Size
  0%|          | 0/135 [00:00<?, ?it/s]  0%|          | 0/135 [00:00<?, ?it/s]
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py", line 13, in <module>
[rank0]:     results = trainer.train()
[rank0]:               ^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 207, in train
[rank0]:     self._do_train(world_size)
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 380, in _do_train
[rank0]:     self.loss, self.loss_items = self.model(batch)
[rank0]:                                  ^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank0]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank0]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank0]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 113, in forward
[rank0]:     return self.loss(x, *args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 294, in loss
[rank0]:     preds = self.forward(batch["img"]) if preds is None else preds
[rank0]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 114, in forward
[rank0]:     return self.predict(x, *args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 132, in predict
[rank0]:     return self._predict_once(x, profile, visualize, embed)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 153, in _predict_once
[rank0]:     x = m(x)  # run
[rank0]:         ^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 239, in forward
[rank0]:     y.extend(m(y[-1]) for m in self.m)
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 239, in <genexpr>
[rank0]:     y.extend(m(y[-1]) for m in self.m)
[rank0]:              ^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 264, in forward
[rank0]:     return self.cv3(torch.cat((self.m(self.cv1(x)), self.cv2(x)), 1))
[rank0]:                                ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/container.py", line 250, in forward
[rank0]:     input = module(input)
[rank0]:             ^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 348, in forward
[rank0]:     return x + self.cv2(self.cv1(x)) if self.add else self.cv2(self.cv1(x))
[rank0]:                         ^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/conv.py", line 51, in forward
[rank0]:     return self.act(self.bn(self.conv(x)))
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/activation.py", line 432, in forward
[rank0]:     return F.silu(input, inplace=self.inplace)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/functional.py", line 2379, in silu
[rank0]:     return torch._C._nn.silu_(input)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 14.00 MiB. GPU 0 has a total capacity of 23.69 GiB of which 32.56 MiB is free. Process 129396 has 13.87 GiB memory in use. Including non-PyTorch memory, this process has 9.20 GiB memory in use. Of the allocated memory 8.66 GiB is allocated by PyTorch, and 99.51 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Exception in thread Thread-3 (_pin_memory_loop):
Traceback (most recent call last):
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/threading.py", line 1073, in _bootstrap_inner
    self.run()
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/threading.py", line 1010, in run
    self._target(*self._args, **self._kwargs)
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py", line 59, in _pin_memory_loop
    do_one_step()
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/utils/data/_utils/pin_memory.py", line 35, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/multiprocessing/reductions.py", line 541, in rebuild_storage_fd
    fd = df.detach()
         ^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/connection.py", line 524, in Client
    answer_challenge(c, authkey)
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/connection.py", line 952, in answer_challenge
    message = connection.recv_bytes(256)         # reject large message
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/multiprocessing/connection.py", line 395, in _recv
    chunk = read(handle, remaining)
            [rank3]: Traceback (most recent call last):
[rank3]:   File "/home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py", line 13, in <module>
[rank3]:     results = trainer.train()
[rank3]:               ^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 207, in train
[rank3]:     self._do_train(world_size)
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 380, in _do_train
[rank3]:     self.loss, self.loss_items = self.model(batch)
[rank3]:                                  ^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank3]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank3]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank3]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 113, in forward
[rank3]:     return self.loss(x, *args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 294, in loss
[rank3]:     preds = self.forward(batch["img"]) if preds is None else preds
[rank3]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 114, in forward
[rank3]:     return self.predict(x, *args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 132, in predict
[rank3]:     return self._predict_once(x, profile, visualize, embed)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 153, in _predict_once
[rank3]:     x = m(x)  # run
[rank3]:         ^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/head.py", line 190, in forward
[rank3]:     p = self.proto(x[0])  # mask protos
[rank3]:         ^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 95, in forward
[rank3]:     return self.cv3(self.cv2(self.upsample(self.cv1(x))))
[rank3]:                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank3]:     return self._call_impl(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank3]:     return forward_call(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 1162, in forward
[rank3]:     return F.conv_transpose2d(
[rank3]:            ^^^^^^^^^^^^^^^^^^^
[rank3]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 208.00 MiB. GPU 3 has a total capacity of 23.69 GiB of which 186.81 MiB is free. Process 129399 has 13.57 GiB memory in use. Including non-PyTorch memory, this process has 9.92 GiB memory in use. Of the allocated memory 9.39 GiB is allocated by PyTorch, and 87.03 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank1]: Traceback (most recent call last):
[rank1]:   File "/home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py", line 13, in <module>
[rank1]:     results = trainer.train()
[rank1]:               ^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 207, in train
[rank1]:     self._do_train(world_size)
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 380, in _do_train
[rank1]:     self.loss, self.loss_items = self.model(batch)
[rank1]:                                  ^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank1]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank1]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank1]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 113, in forward
[rank1]:     return self.loss(x, *args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 294, in loss
[rank1]:     preds = self.forward(batch["img"]) if preds is None else preds
[rank1]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 114, in forward
[rank1]:     return self.predict(x, *args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 132, in predict
[rank1]:     return self._predict_once(x, profile, visualize, embed)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 153, in _predict_once
[rank1]:     x = m(x)  # run
[rank1]:         ^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/head.py", line 190, in forward
[rank1]:     p = self.proto(x[0])  # mask protos
[rank1]:         ^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 95, in forward
[rank1]:     return self.cv3(self.cv2(self.upsample(self.cv1(x))))
[rank1]:                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank1]:     return self._call_impl(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank1]:     return forward_call(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 1162, in forward
[rank1]:     return F.conv_transpose2d(
[rank1]:            ^^^^^^^^^^^^^^^^^^^
[rank1]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 208.00 MiB. GPU 1 has a total capacity of 23.69 GiB of which 80.81 MiB is free. Process 129397 has 13.68 GiB memory in use. Including non-PyTorch memory, this process has 9.92 GiB memory in use. Of the allocated memory 9.39 GiB is allocated by PyTorch, and 87.03 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[rank2]: Traceback (most recent call last):
[rank2]:   File "/home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py", line 13, in <module>
[rank2]:     results = trainer.train()
[rank2]:               ^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 207, in train
[rank2]:     self._do_train(world_size)
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 380, in _do_train
[rank2]:     self.loss, self.loss_items = self.model(batch)
[rank2]:                                  ^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1643, in forward
[rank2]:     else self._run_ddp_forward(*inputs, **kwargs)
[rank2]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/parallel/distributed.py", line 1459, in _run_ddp_forward
[rank2]:     return self.module(*inputs, **kwargs)  # type: ignore[index]
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 113, in forward
[rank2]:     return self.loss(x, *args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 294, in loss
[rank2]:     preds = self.forward(batch["img"]) if preds is None else preds
[rank2]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 114, in forward
[rank2]:     return self.predict(x, *args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 132, in predict
[rank2]:     return self._predict_once(x, profile, visualize, embed)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/tasks.py", line 153, in _predict_once
[rank2]:     x = m(x)  # run
[rank2]:         ^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/head.py", line 190, in forward
[rank2]:     p = self.proto(x[0])  # mask protos
[rank2]:         ^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/nn/modules/block.py", line 95, in forward
[rank2]:     return self.cv3(self.cv2(self.upsample(self.cv1(x))))
[rank2]:                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
[rank2]:     return self._call_impl(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
[rank2]:     return forward_call(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/home/xin99/.local/lib/python3.12/site-packages/torch/nn/modules/conv.py", line 1162, in forward
[rank2]:     return F.conv_transpose2d(
[rank2]:            ^^^^^^^^^^^^^^^^^^^
[rank2]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 208.00 MiB. GPU 2 has a total capacity of 23.69 GiB of which 204.81 MiB is free. Process 129398 has 13.55 GiB memory in use. Including non-PyTorch memory, this process has 9.92 GiB memory in use. Of the allocated memory 9.39 GiB is allocated by PyTorch, and 87.03 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
W0309 22:55:43.679000 259946 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 259984 closing signal SIGTERM
W0309 22:55:43.681000 259946 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 259986 closing signal SIGTERM
W0309 22:55:43.683000 259946 torch/distributed/elastic/multiprocessing/api.py:897] Sending process 259987 closing signal SIGTERM
E0309 22:55:44.299000 259946 torch/distributed/elastic/multiprocessing/api.py:869] failed (exitcode: 1) local_rank: 1 (pid: 259985) of binary: /home/xin99/anaconda3/envs/bloodScan/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/distributed/run.py", line 923, in <module>
    main()
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 355, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/distributed/run.py", line 919, in main
    run(args)
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/.local/lib/python3.12/site-packages/torch/distributed/launcher/api.py", line 269, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
/home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-03-09_22:55:43
  host      : amax
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 259985)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
Traceback (most recent call last):
  File "/home/xin99/BloodScan/tests/yolo_seg/yolo_train.py", line 15, in <module>
    results = model.train(data = dataset, 
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/model.py", line 806, in train
    self.trainer.train()
  File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 202, in train
    raise e
  File "/home/xin99/.local/lib/python3.12/site-packages/ultralytics/engine/trainer.py", line 200, in train
    subprocess.run(cmd, check=True)
  File "/home/xin99/anaconda3/envs/bloodScan/lib/python3.12/subprocess.py", line 571, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/home/xin99/anaconda3/envs/bloodScan/bin/python', '-m', 'torch.distributed.run', '--nproc_per_node', '4', '--master_port', '37811', '/home/xin99/.config/Ultralytics/DDP/_temp_l7nnrcoj139721875356896.py']' returned non-zero exit status 1.
